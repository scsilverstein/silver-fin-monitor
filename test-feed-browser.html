<!DOCTYPE html>
<html>
<head>
    <title>Feed Creation Test</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>Feed Creation Test</h1>
    <button id="testBtn">Test Feed Creation</button>
    <pre id="output"></pre>
    
    <script>
        const API_URL = 'http://localhost:3001/api/v1';
        const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkZW1vLXVzZXItaWQiLCJlbWFpbCI6ImRlbW9Ac2lsdmVyZmluLmNvbSIsInJvbGUiOiJhZG1pbiIsImlhdCI6MTc1MzE4ODU3NiwiZXhwIjoxNzUzNzkzMzc2fQ.6ArltQY-pM2fBvtkl7R0VvOeeOTTo0ewix63HOdghLs';
        
        async function testFeedCreation() {
            const output = document.getElementById('output');
            output.textContent = 'Testing feed creation...\n\n';
            
            const feedData = {
                name: 'Browser Test Feed ' + Date.now(),
                type: 'rss',
                url: 'https://example.com/browser-feed-' + Date.now() + '.xml',
                config: {
                    categories: ['finance', 'technology'],
                    priority: 'medium',
                    updateFrequency: 'hourly'
                }
            };
            
            output.textContent += 'Request data:\n' + JSON.stringify(feedData, null, 2) + '\n\n';
            
            try {
                const response = await axios.post(`${API_URL}/feeds`, feedData, {
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                output.textContent += 'Success! Response:\n' + JSON.stringify(response.data, null, 2);
            } catch (error) {
                output.textContent += 'Error occurred:\n';
                if (error.response) {
                    output.textContent += 'Status: ' + error.response.status + '\n';
                    output.textContent += 'Response: ' + JSON.stringify(error.response.data, null, 2) + '\n';
                } else {
                    output.textContent += 'Error: ' + error.message + '\n';
                }
                console.error('Full error:', error);
            }
        }
        
        document.getElementById('testBtn').addEventListener('click', testFeedCreation);
    </script>
</body>
</html>